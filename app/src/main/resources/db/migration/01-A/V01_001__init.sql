--------------------------------------------------------------------------------
-- Title:  Initial database script
-- Date:   2025-05-29
-- Author: Paul Poley
--
-- Comments: Initial table creation, etc.
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- DB Users, Permissions...
--------------------------------------------------------------------------------

--N/A

--------------------------------------------------------------------------------
-- Tables, Tablespaces, Sequences, Comments
--------------------------------------------------------------------------------

CREATE TABLE public.user
(
	id                                   BIGSERIAL,
	email                                varchar(256) NOT NULL,
	name                                 varchar(256) NOT NULL,
	CONSTRAINT pk_user                   PRIMARY KEY(id)
)
	TABLESPACE pg_default
;
COMMENT ON TABLE public.user IS 'A user of the platform';
COMMENT ON COLUMN public.user.email IS 'The email address for the user';
COMMENT ON COLUMN public.user.name IS 'The name of the user';

--------------------------------------------------------------------------------
-- Sequence Alteration
--------------------------------------------------------------------------------

--N/A

--------------------------------------------------------------------------------
-- Functions, Procedures
--------------------------------------------------------------------------------

--N/A

--------------------------------------------------------------------------------
-- Triggers
--------------------------------------------------------------------------------

--N/A

--------------------------------------------------------------------------------
-- Indexes
--------------------------------------------------------------------------------

CREATE INDEX user__email__idx ON public.user (email);

--------------------------------------------------------------------------------
-- Foreign Keys, Constraints...
--------------------------------------------------------------------------------

--Ensure user.email is case-insensitive unique. We can't do a regular unique "constraint" while using LOWER().
CREATE UNIQUE INDEX uq_user__lower_email__idx ON public.user (LOWER(email));

--------------------------------------------------------------------------------
-- Data
--------------------------------------------------------------------------------

--N/A

--------------------------------------------------------------------------------
-- Rollback
--------------------------------------------------------------------------------

--N/A
